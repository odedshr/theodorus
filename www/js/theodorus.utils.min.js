/*! theodorus 2014-09-20 */
!function(){if("undefined"!=typeof exports){{var a=require("crypto");(function(){function a(a){K=a,L=new Array(K);for(var c=0;c<L.length;c++)L[c]=0;M=new b,N=new b,N.digits[0]=1}function b(a){this.digits="boolean"==typeof a&&a===!0?null:L.slice(0),this.isNeg=!1}function c(a){var c=new b(!0);return c.digits=a.digits.slice(0),c.isNeg=a.isNeg,c}function d(a){var c=new b;c.isNeg=0>a,a=Math.abs(a);for(var d=0;a>0;)c.digits[d++]=a&S,a>>=biRadixBits;return c}function e(a){for(var b="",c=a.length-1;c>-1;--c)b+=a.charAt(c);return b}function f(a,c){var d=new b;d.digits[0]=c;for(var f=B(a,d),g=T[f[1].digits[0]];1==A(f[0],M);)f=B(f[0],d),digit=f[1].digits[0],g+=T[f[1].digits[0]];return(a.isNeg?"-":"")+e(g)}function g(a){var b=15,c="";for(i=0;4>i;++i)c+=U[a&b],a>>>=4;return e(c)}function h(a){for(var b="",c=(q(a),q(a));c>-1;--c)b+=g(a.digits[c]);return b}function k(a){var b,c=48,d=c+9,e=97,f=e+25,g=65,h=90;return b=a>=c&&d>=a?a-c:a>=g&&h>=a?10+a-g:a>=e&&f>=a?10+a-e:0}function l(a){for(var b=0,c=Math.min(a.length,4),d=0;c>d;++d)b<<=4,b|=k(a.charCodeAt(d));return b}function m(a){for(var c=new b,d=a.length,e=d,f=0;e>0;e-=4,++f)c.digits[f]=l(a.substr(Math.max(e-4,0),Math.min(e,4)));return c}function n(a,c){var d="-"==a.charAt(0),e=d?1:0,f=new b,g=new b;g.digits[0]=1;for(var h=a.length-1;h>=e;h--){var i=a.charCodeAt(h),j=k(i),l=t(g,j);f=o(f,l),g=t(g,c)}return f.isNeg=d,f}function o(a,c){var d;if(a.isNeg!=c.isNeg)c.isNeg=!c.isNeg,d=p(a,c),c.isNeg=!c.isNeg;else{d=new b;for(var e,f=0,g=0;g<a.digits.length;++g)e=a.digits[g]+c.digits[g]+f,d.digits[g]=65535&e,f=Number(e>=P);d.isNeg=a.isNeg}return d}function p(a,c){var d;if(a.isNeg!=c.isNeg)c.isNeg=!c.isNeg,d=o(a,c),c.isNeg=!c.isNeg;else{d=new b;var e,f;f=0;for(var g=0;g<a.digits.length;++g)e=a.digits[g]-c.digits[g]+f,d.digits[g]=65535&e,d.digits[g]<0&&(d.digits[g]+=P),f=0-Number(0>e);if(-1==f){for(f=0,g=0;g<a.digits.length;++g)e=0-d.digits[g]+f,d.digits[g]=65535&e,d.digits[g]<0&&(d.digits[g]+=P),f=0-Number(0>e);d.isNeg=!a.isNeg}else d.isNeg=a.isNeg}return d}function q(a){for(var b=a.digits.length-1;b>0&&0===a.digits[b];)--b;return b}function r(a){var b,c=q(a),d=a.digits[c],e=(c+1)*O;for(b=e;b>e-O&&0===(32768&d);--b)d<<=1;return b}function s(a,c){for(var d,e,f,g=new b,h=q(a),i=q(c),k=0;i>=k;++k){for(d=0,f=k,j=0;h>=j;++j,++f)e=g.digits[f]+a.digits[j]*c.digits[k]+d,g.digits[f]=e&S,d=e>>>biRadixBits;g.digits[k+h+1]=d}return g.isNeg=a.isNeg!=c.isNeg,g}function t(a,c){var d,e,f;result=new b,d=q(a),e=0;for(var g=0;d>=g;++g)f=result.digits[g]+a.digits[g]*c+e,result.digits[g]=f&S,e=f>>>biRadixBits;return result.digits[1+d]=e,result}function u(a,b,c,d,e){for(var f=Math.min(b+e,a.length),g=b,h=d;f>g;++g,++h)c[h]=a[g]}function v(a,c){var d=Math.floor(c/O),e=new b;u(a.digits,0,e.digits,d,e.digits.length-d);for(var f=c%O,g=O-f,h=e.digits.length-1,i=h-1;h>0;--h,--i)e.digits[h]=e.digits[h]<<f&S|(e.digits[i]&V[f])>>>g;return e.digits[0]=e.digits[h]<<f&S,e.isNeg=a.isNeg,e}function w(a,c){var d=Math.floor(c/O),e=new b;u(a.digits,d,e.digits,0,a.digits.length-d);for(var f=c%O,g=O-f,h=0,i=h+1;h<e.digits.length-1;++h,++i)e.digits[h]=e.digits[h]>>>f|(e.digits[i]&W[f])<<g;return e.digits[e.digits.length-1]>>>=f,e.isNeg=a.isNeg,e}function x(a,c){var d=new b;return u(a.digits,0,d.digits,c,d.digits.length-c),d}function y(a,c){var d=new b;return u(a.digits,c,d.digits,0,d.digits.length-c),d}function z(a,c){var d=new b;return u(a.digits,0,d.digits,0,c),d}function A(a,b){if(a.isNeg!=b.isNeg)return 1-2*Number(a.isNeg);for(var c=a.digits.length-1;c>=0;--c)if(a.digits[c]!=b.digits[c])return a.isNeg?1-2*Number(a.digits[c]>b.digits[c]):1-2*Number(a.digits[c]<b.digits[c]);return 0}function B(a,d){var e,f,g=r(a),h=r(d),i=d.isNeg;if(h>g)return a.isNeg?(e=c(N),e.isNeg=!d.isNeg,a.isNeg=!1,d.isNeg=!1,f=p(d,a),a.isNeg=!0,d.isNeg=i):(e=new b,f=c(a)),new Array(e,f);e=new b,f=a;for(var j=Math.ceil(h/O)-1,k=0;d.digits[j]<Q;)d=v(d,1),++k,++h,j=Math.ceil(h/O)-1;f=v(f,k),g+=k;for(var l=Math.ceil(g/O)-1,m=x(d,l-j);-1!=A(f,m);)++e.digits[l-j],f=p(f,m);for(var n=l;n>j;--n){var s=n>=f.digits.length?0:f.digits[n],u=n-1>=f.digits.length?0:f.digits[n-1],y=n-2>=f.digits.length?0:f.digits[n-2],z=j>=d.digits.length?0:d.digits[j],B=j-1>=d.digits.length?0:d.digits[j-1];e.digits[n-j-1]=s==z?S:Math.floor((s*P+u)/z);for(var C=e.digits[n-j-1]*(z*P+B),D=s*R+(u*P+y);C>D;)--e.digits[n-j-1],C=e.digits[n-j-1]*(z*P|B),D=s*P*P+(u*P+y);m=x(d,n-j-1),f=p(f,t(m,e.digits[n-j-1])),f.isNeg&&(f=o(f,m),--e.digits[n-j-1])}return f=w(f,k),e.isNeg=a.isNeg!=i,a.isNeg&&(e=i?o(e,N):p(e,N),d=w(d,k),f=p(d,f)),0===f.digits[0]&&0===q(f)&&(f.isNeg=!1),[e,f]}function C(a,b){return B(a,b)[0]}function D(a){this.modulus=c(a),this.k=q(this.modulus)+1;var d=new b;d.digits[2*this.k]=1,this.mu=C(d,this.modulus),this.bkplus1=new b,this.bkplus1.digits[this.k+1]=1,this.modulo=E,this.multiplyMod=F,this.powMod=G}function E(a){var b=y(a,this.k-1),c=s(b,this.mu),d=y(c,this.k+1),e=z(a,this.k+1),f=s(d,this.modulus),g=z(f,this.k+1),h=p(e,g);h.isNeg&&(h=o(h,this.bkplus1));for(var i=A(h,this.modulus)>=0;i;)h=p(h,this.modulus),i=A(h,this.modulus)>=0;return h}function F(a,b){var c=s(a,b);return this.modulo(c)}function G(a,c){var d=new b;d.digits[0]=1;for(var e=a,f=c;;){if(0!==(1&f.digits[0])&&(d=this.multiplyMod(d,e)),f=w(f,1),0===f.digits[0]&&0===q(f))break;e=this.multiplyMod(e,e)}return d}function H(a,b,c){this.e=m(a),this.d=m(b),this.m=m(c),this.chunkSize=2*q(this.m),this.radix=16,this.barrett=new D(this.m)}function I(a,c){for(var d=[],e=c.length,g=0;e>g;)d[g]=c.charCodeAt(g),g++;for(;d.length%a.chunkSize!==0;)d[g++]=0;var i,j,k,l=d.length,m="";for(g=0;l>g;g+=a.chunkSize){for(k=new b,i=0,j=g;j<g+a.chunkSize;++i)k.digits[i]=d[j++],k.digits[i]+=d[j++]<<8;var n=a.barrett.powMod(k,a.e),o=16==a.radix?h(n):f(n,a.radix);m+=o+" "}return m.substring(0,m.length-1)}function J(a,b){var c,d,e,f=b.split(" "),g="";for(c=0;c<f.length;++c){var h;for(h=16==a.radix?m(f[c]):n(f[c],a.radix),e=a.barrett.powMod(h,a.d),d=0;d<=q(e);++d)g+=String.fromCharCode(255&e.digits[d],e.digits[d]>>8)}return 0===g.charCodeAt(g.length-1)&&(g=g.substring(0,g.length-1)),g}var K,L,M,N,O=biRadixBits=16,P=65536,Q=P>>>1,R=P*P,S=P-1;a(20);var T=(d(1e15),["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"]),U=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],V=[0,32768,49152,57344,61440,63488,64512,65024,65280,65408,65472,65504,65520,65528,65532,65534,65535],W=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];exports.generateKey=function(a,b,c){return{key:new H(a,b,c),encrypt:function(a){return I(this.key,a)},decrypt:function(a){return J(this.key,a)}}}})()}Encryption=function(){return{rsaKeys:{},init:function(a){var b=a("application_name",!0);return this.rsaKeys=exports.generateKey(a(b+"_RSA_ENCRYPT",!0),a(b+"_RSA_DECRYPT",!0),a(b+"_RSA_MODULUS",!0)),this},encrypt:function(b){return a.createHash("md5").update(b).digest("hex")},rsaEncrypt:function(a){return this.rsaKeys.encrypt(a)},rsaDecrypt:function(a){return this.rsaKeys.decrypt(a)}}}(),exports.init=Encryption.init.bind(Encryption),exports.encrypt=Encryption.encrypt.bind(Encryption),exports.rsaEncrypt=Encryption.rsaEncrypt.bind(Encryption),exports.rsaDecrypt=Encryption.rsaDecrypt.bind(Encryption)}}();var ExternalWindow=function(){var a=function(){return{open:function(a,b){return this.callback=b,this.externalWindow=window.open(a),this.externalWindow},callback:function(a){this.externalWindow?(this.externalWindow.close(),this.externalWindow=null):console.error("no this.externalWindow?! how you go here?"),this.callback(a)},windowCallback:function(a){"undefined"==typeof a.error?window.opener?(window.opener.ExternalWindow.callback(a),window.close()):location.href=location.href.substr(0,location.href.indexOf("?")):XSLT.transform($("#messages"),{message:{"@type":"error",message:error}})}}}();return a}(),FormGrabber=function(){var a=function(){return{get:function(a){var b=a.elements,c={};for(var d in b){var e=b[d];e.name&&(c[e.name]="checkbox"==e.type?e.checked:e.value)}return c}}}();return a}(),PrettyDate=function(){var a=function(){return{pretty:function(a){var b=new Date(a||""),c=((new Date).getTime()-b.getTime())/1e3,d=Math.floor(c/86400);return isNaN(d)||0>d||d>=31?a:0===d&&(60>c&&"just-now"||120>c&&"a-minute-ago"||240>c&&"two-minutes-ago"||900>c&&Math.floor(c/60)+"-minutes-ago"||1800>c&&"quarter-of-an-hour-ago"||2400>c&&"half-of-an-hour-ago"||3600>c&&Math.floor(c/60)+"-minutes-ago"||7200>c&&"an-hour-ago"||1440>c&&"two-hours-ago"||86400>c&&Math.floor(c/3600)+"-hours-ago")||1==d&&"yesterday"||2==d&&"two-days-ago"||7>d&&d+"-days-ago"||14>d&&"a-week-ago"||21>d&&"two-weeks-ago"||31>d&&Math.ceil(d/7)+"-weeks-ago"},normal:function(a){var b=new Date(a);return("0"+(b.getDate()+1)).slice(-2)+"/"+("0"+(b.getMonth()+1)).slice(-2)+"/"+b.getFullYear()+", "+("0"+b.getHours()).slice(-2)+":"+("0"+b.getMinutes()).slice(-2)},render:function(a){var b=!1,c={};return a&&"undefined"!=typeof a&&(c.timestamp=a,c.formatted=this.normal(a),b=this.pretty(a),b!==a&&(c.pattern=b.replace(/(\d)+/g,"#"),c.patternValue=Number(b.replace(/\D/g,"")))),c}}}();return"undefined"!=typeof exports&&(exports.renderer=a.render.bind(a)),a}(),XSLT=function(){var a=function(){return{uiVersion:"?",templateFolder:!1,useLocalStorage:!1,json2xmlEngine:function(a,b,c){var d,e,f=["undefined","function"],g="",h="";if(a&&a.toJSON&&"function"==typeof a.toJSON&&(a=a.toJSON()),a instanceof Array)for(var i=0,j=a.length;j>i;i++)g+=c+this.json2xmlEngine(a[i],b,c+"	")+"\n";else if("object"==typeof a){g+="\n"+c+"<"+b;for(e in a)"@"==e.charAt(0)?g+=" "+e.substr(1)+'="'+a[e].toString()+'"':(d=a[e],-1==f.indexOf(typeof d)&&(h+="#text"==e?d:"#cdata"==e?"<![CDATA["+d+"]]>":this.json2xmlEngine(d,e,c+"	")));g+=h.length?">"+h+"</"+b+">":"/>"}else g+="\n"+c+("<"+b+">"+a.toString()+"</"+b+">");return g},json2xml:function(a,b){var c="";for(var d in a)c+=this.json2xmlEngine(a[d],d,"");return b?c.replace(/\t/g,b):c.replace(/\t|\n/g,"")}}}();return"undefined"!=typeof exports?(a.engine=require("node_xslt"),a.cheerio=require("cheerio"),a.transform=function(b){try{"object"==typeof b&&(b.app&&(b.app["@version"]=this.uiVersion),b=this.json2xml(b));var c=this.engine.readXsltFile(this.templateFolder+"/xslt/default.xsl"),d=this.engine.readXmlString("<xml>"+b+"</xml>"),e=this.engine.transform(c,d,["language","'hebrew'"]),f=a.cheerio.load(e);return f("#plugins").children().each(function(a,b){try{var c=f(this).attr("class").match(/reposition-(\w*)-([\w\d\-_]*)/);if(c){var d=c[1],e=f("#"+c[2]);if("null"!=e.html())switch(d){case"before":e.before(b);break;case"prepend":e.prepend(b);break;case"append":e.append(b);break;case"after":e.after(b)}}}catch(g){console.error("failed to reposition item #"+a+":"+f(this).html())}}),f.html()}catch(g){return console.error("failed to xslt "+("object"==typeof b?this.json2xml(b):b)+"\n"+g),""}},a.init=function(b,c){if("string"!=typeof b)throw{message:"xslt-must-have-templateFolder"};return a.templateFolder=b,a.uiVersion=c,a.transform.bind(a)},exports.init=a.init):($.getScript("/lib/jquery.transform.js",function(){}),a.transform=function(a,b,c){var d={async:!1,xslCache:!0,xmlstr:"<xml>"+("string"==typeof b?b:this.json2xml(b))+"</xml>",xsl:"/ui/xslt/default.xsl",success:c,error:function(a){console.error("error transforming "+a)}};this.useLocalStorage?d.xslstr=localStorage.getItem("default.xsl"):d.xsl="/ui/xslt/default.xsl";try{(a?$(a):$).transform(d)}catch(e){console.error("failed to xslt: "+e+"\n"+b)}},a.preloadXSLT=function(a){function b(a,c){var d={};$.ajax({cache:"true",dataType:"text",url:"/ui/xslt/"+a,success:function(e){localStorage.setItem(a,e);var f=e.match(/<xsl:import href="([a-zA-Z0-9\-_.]+)" \/>/g);if(f&&f.length){d[a]=f.length;var g=function(){d[a]--,d[a]||c()};for(var h in f)b(f[h].match(/"([a-zA-Z0-9\-_.]+)"/)[0].replace(/"/g,""),g)}else c()}})}b("default.xsl",a)}),a}();